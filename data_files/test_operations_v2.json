{
  "operations": [
    {
      "type": "text",
      "placeholder": "report_no",
      "value": "metadata.report_no",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "issue_date",
      "value": "metadata.issue_date",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "applicant_name",
      "value": "metadata.applicant_name",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "applicant_address",
      "value": "metadata.applicant_address",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "model_identifier",
      "value": "extracted_data.model_identifier",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "rated_wattage",
      "value": "extracted_data.rated_wattage",
      "location": "body"
    },
    {
      "type": "text",
      "placeholder": "energy_class_rating",
      "value": "calculated_data.energy_class_rating",
      "location": "body"
    },
    {
      "type": "table",
      "placeholder": "photometric_data",
      "table_template_path": "report_templates/tables/photometric_table_template.docx",
      "table_data": "extracted_data.photometric_data",
      "transformations": [
        {
          "type": "skip_columns",
          "columns": [1]
        },
        {
          "type": "custom_transform",
          "transformer": "photometric_data_transformer",
          "calculate_columns": [],
          "formulas": {},
          "average_columns": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
          "format_rules": {
            "2": [{"condition": "x < 100", "format": "{:.2f}"}],
            "4": [{"condition": "x >= 100", "format": "{:.1f}"}, {"condition": "x < 100", "format": "{:.2f}"}],
            "5": [{"condition": "x >= 100", "format": "{:.1f}"}, {"condition": "x < 100", "format": "{:.2f}"}]
          },
          "average_format_rules": {
            "2": [{"condition": "x < 100", "format": "{:.2f}"}],
            "4": [{"condition": "x >= 100", "format": "{:.1f}"}, {"condition": "x < 100", "format": "{:.2f}"}],
            "5": [{"condition": "x >= 100", "format": "{:.1f}"}, {"condition": "x < 100", "format": "{:.2f}"}]
          }
        }
      ],
      "row_strategy": "fixed_rows",
      "header_rows": 2,
      "skip_columns": [1]
    },
    {
      "type": "table",
      "placeholder": "beam_table",
      "table_template_path": "report_templates/tables/beam_table_template.docx",
      "table_data": "extracted_data.beam_data",
      "transformations": [
        {
          "type": "custom_transform",
          "transformer": "beam_table_transformer",
          "beam_angle_field": "beam_angle_0",
          "peak_intensity_field": "peak_intensity_0",
          "beam_angle_format": "{:.1f}",
          "peak_intensity_format": "{:.0f}"
        }
      ],
      "row_strategy": "fixed_rows",
      "header_rows": 1
    },
    {
      "type": "table",
      "placeholder": "eei_table",
      "table_template_path": "report_templates/tables/eei_table_template.docx",
      "table_data": "extracted_data.eei_data",
      "transformations": [
        {
          "type": "custom_transform",
          "transformer": "eei_table_transformer",
          "model_fields": ["model_identifier"],
          "photometric_data_ref": "photometric_data",
          "efficacy_column": 6,
          "eei_thresholds": {
            "A++": 130,
            "A+": 110,
            "A": 90,
            "B": 70,
            "C": 50,
            "D": 30
          },
          "merge_columns": [3, 4],
          "format_rules": {
            "1": [{"condition": "x >= 100", "format": "{:.1f}"}, {"condition": "x < 100", "format": "{:.2f}"}]
          }
        }
      ],
      "row_strategy": "dynamic_rows",
      "header_rows": 1
    },
    {
      "type": "table",
      "placeholder": "zone_table",
      "table_template_path": "report_templates/tables/zone_table_template.docx",
      "table_data": "extracted_data.zone_data",
      "transformations": [
        {
          "type": "custom_transform",
          "transformer": "zone_table_transformer",
          "zone_angles": [30, 60, 90, 120, 150, 180],
          "beam_angle_field": "beam_angle_0",
          "min_angle": 30,
          "format": "{:.1f}"
        }
      ],
      "row_strategy": "dynamic_rows",
      "header_rows": 1
    },
    {
      "type": "table",
      "placeholder": "life_table",
      "table_template_path": "report_templates/tables/life_test_table_template.docx",
      "table_data": "extracted_data.life_test_data",
      "transformations": [
        {
          "type": "custom_transform",
          "transformer": "life_table_transformer",
          "calculate_columns": [],
          "formulas": {},
          "average_columns": [1, 2, 3],
          "format_rules": {
            "1": [{"condition": "x >= 1000", "format": "{:.0f}"}, {"condition": "x < 1000", "format": "{:.1f}"}]
          }
        }
      ],
      "row_strategy": "fixed_rows",
      "header_rows": 2
    },
    {
      "type": "image",
      "placeholder": "images",
      "image_paths": ["data_files/1.jpg", "data_files/2.jpg"],
      "width": 4.0,
      "alignment": "center",
      "location": "body"
    }
  ]
}
