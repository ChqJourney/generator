{
  "template_path": "report_templates/report_template1.docx",
  "output_dir": "output/",
  "field_mappings": [
    {
      "template_field": "report_no",
      "source": "metadata",
      "source_field": "report_no",
      "type": "text"
    },
    {
      "template_field": "issue_date",
      "source": "metadata",
      "source_field": "issue_date",
      "type": "text"
    },
    {
      "template_field": "model_identifier",
      "source": "extracted_data",
      "source_field": "model_identifier",
      "type": "text"
    },
    {
      "template_field": "rated_wattage",
      "source": "extracted_data",
      "source_field": "rated_wattage",
      "type": "text"
    },
    {
      "template_field": "photometric_data",
      "source": "extracted_data",
      "source_field": "photometric_data",
      "table_template_path": "report_templates/photometric_table_template.docx",
      "type": "table",
      "row_strategy": "fixed_rows",
      "header_rows": 2,
      "target_headers": [
        "model_identifier",
      "sequence_no",
      "Current",
      "Power",
      "PF",
      "Total Luminous Flux",
      "Efficacy",
      "CCT",
      "Ra",
      "R9",
      "X",
      "Y",
      "SDCM",
      "Flicker Pst LM",
      "Stroboscopic Effect SVM",
      "Standby Power Psb"
    ],
      "transformations": [
        {
          "type": "add_column",
          "position": 0,
          "source": "metadata:model_identifier"
        },
        {
          "type": "calculate",
          "column": 1,
          "operation": "average",
          "decimal": 2
        },
        {
          "type": "calculate",
          "column": 2,
          "operation": "average",
          "decimal": 4
        },
        {
          "type": "calculate",
          "column": 3,
          "operation": "average",
          "decimal": 4
        },
        {
          "type": "calculate",
          "column": 4,
          "operation": "average",
          "decimal": 1
        },
        {
          "type": "calculate",
          "column": 5,
          "operation": "formula=F{row}/C{row}",
          "decimal": 2
        },
        
        {
          "type": "calculate",
          "column": 7,
          "operation": "average",
          "decimal": 0
        },
        {
          "type": "calculate",
          "column": 8,
          "operation": "average",
          "decimal": 0
        },
        {
          "type": "calculate",
          "column": 9,
          "operation": "average",
          "decimal": 4
        },
        {
          "type": "calculate",
          "column": 10,
          "operation": "average",
          "decimal": 4
        },
        {
          "type": "calculate",
          "column": 11,
          "operation": "average",
          "decimal": 4
        },
        {
          "type": "calculate",
          "column": 12,
          "operation": "average",
          "decimal": 2
        }
      ]
    },
    {
      "template_field": "images",
      "source": "extracted_data",
      "source_field": "images",
      "type": "image",
      "width": 4.0,
      "alignment": "center"
    }
  ],
  "merge_strategy": "prefer_first"
}
